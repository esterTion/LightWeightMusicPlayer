MusicPlayer=function(c){if(!c.element||!c.src){return false}this.element=c.element;this.config=c;if(document.getElementById(this.config.id||"")!=null){console.warn("existing element id, ignoring and generating new id");delete this.config.id}var a={color:{played:"#FFFFFF",buffered:"#C8C7C7",blank:"#918F8F",border:"#000000"},id:"MusicPlayer_"+Date.now(),borderWidth:0,autoPlay:false,loop:false},f=document.createElement("div"),e,d;for(e of ["id","borderWidth","autoPlay","loop"]){this.config[e]=this.config[e]||a[e]}for(e of ["color"]){if(this.config[e]==undefined){this.config[e]=a[e];break}for(d in a[e]){this.config[e][d]=this.config[e][d]||a[e][d]}}f.id=this.config.id;this.element.appendChild(f);f.innerHTML='<div class="warpper"><div class="buffered"></div><div class="played"></div><div class="icon"></div><style>#'+this.config.id+"{height:20px;width:100%;position:relative;background:"+this.config.color.border+";cursor:pointer}#"+this.config.id+" .warpper{background:"+this.config.color.blank+";position:absolute;left:"+this.config.borderWidth+";right:"+this.config.borderWidth+";top:"+this.config.borderWidth+";bottom:"+this.config.borderWidth+"}#"+this.config.id+" .buffered{position:absolute;height:100%;background:"+this.config.color.buffered+"}#"+this.config.id+" .played{position:absolute;height:100%;background:"+this.config.color.played+"}#"+this.config.id+' .icon{height:18px;width:18px;margin:0 auto;opacity:0.5}</style><audio src="'+this.config.src+'"></audio></div>';this.container=document.getElementById(this.config.id);this.barPlay=document.querySelector("#"+this.config.id+" .played");this.barBuffer=document.querySelector("#"+this.config.id+" .buffered");this.audio=document.querySelector("#"+this.config.id+" audio");this.svgIcon=document.querySelector("#"+this.config.id+" .icon");var b=this;this.listeners={timeupdate:function(j){b.barPlay.style.width=(this.currentTime/this.duration*100)+"%";try{var h,j,g=0;for(;g<this.buffered.length;g++){if(this.currentTime>this.buffered.start(g)&&this.currentTime<this.buffered.end(g)){h=this.buffered.start(g);j=this.buffered.end(g);break}}if(g==this.buffered.length){throw"Not Range Found"}b.barBuffer.style.width=(j/this.duration)*100+"%"}catch(j){return}},progress:function(j){try{var h,j,g=0;for(;g<this.buffered.length;g++){if(this.currentTime>this.buffered.start(g)&&this.currentTime<this.buffered.end(g)){h=this.buffered.start(g);j=this.buffered.end(g);break}}if(g==this.buffered.length){throw"Not Range Found"}b.barBuffer.style.width=(j/this.duration)*100+"%"}catch(j){return}},click:function(g){if(b.audio.paused){b.audio.play()}else{b.audio.pause()}},play:function(g){b.svgIcon.innerHTML=b.resource.pause},pause:function(g){b.svgIcon.innerHTML=b.resource.play}};this.audio.addEventListener("timeupdate",this.listeners.timeupdate);this.audio.addEventListener("progress",this.listeners.progress);this.audio.addEventListener("play",this.listeners.play);this.audio.addEventListener("pause",this.listeners.pause);this.container.addEventListener("click",this.listeners.click);if(this.config.autoPlay){this.listeners.click()}if(this.config.loop){this.audio.loop=1}};MusicPlayer.prototype.resource={play:'<svg style="width:18px;height:18px"><polygon style="fill:#333;stroke:#FFF" points="2,2 2,16 16,9"></polygon></svg>',pause:'<svg style="width:18px;height:18px"><polygon style="fill:#333;stroke:#FFF" points="2,2 2,16 8,16 8,2"></polygon><polygon style="fill:#333;stroke:#FFF" points="10,2 10,16 16,16 16,2"></polygon></svg>'};/*end*/